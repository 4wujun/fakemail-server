language: java
sudo: false
jdk:
- oraclejdk8

before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock

cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/

addons:
  sonarcloud:
    organization: patlenain-github
    token:
      secure: iw3LJWmWblNt7K4IBuXQW3y2wz30MwMG70IVbqIJpEg8k1eHAtxZo9M7oq/il07zsHG4n6YWB63w2dt9k7bXYWwI3j5//23B3l/xD7rssETFyO3y4LTMiqPWDev7GXdCcwbLKCQAmLvXB359C8vwkL0AMoqFMTBuelRhme1WzLp6oYldsk5nWHWGErH9LghujxLWmbKCcPtlXWvzGXk/nEAlHQSBSE6mET8uWUPusS2d4J0fsYDbiJmz8ucfSNfriy/CjSZWVumH8fm/xtc2dtgU1bWG9XBXHB/ySRnBhV0iepm5oWyjeCdgvC1NUOjJm2bKNxmiqJVgm1dWfL9kgfonZIlPBLnGPditD5y+eVALdgzhbcIYvA/1188484R1kweUMXBdmP4Vm81vpCV1g3nMEEovOl4mylD50nQSLuvcllFpAqz2GVxf7mSsO4aedYbgrrP9wBZREmcYV+adEXrgSklR9AWtKUG33jLBt1EvQh4x/hYvW3eNSZYZNlPY8abxpV2qZP2RteWJGtOMo/eNiOOx2FJpfxHKIIAqw0giBjhMORzqLE12aHkI4Tf/kAf0bnfhgRai7OTpJ6bOLHR0nIuukcuDxkfHOPNCa8fyetiKm9oRI9mKJhWdz0nKC5vPrbs8PX2K3WQrVoBHsyPyf3tdmKlcRI70wdDhEFA=
    branches:
      - master

after_success:
  gradle check
  gradle sonarqube -Dsonar.host.url=$SONAR_HOST_URL -Dsonar.login=$SONAR_TOKEN -Dsonar.verbose=true

deploy:
  provider: releases
  api_key:
    secure: UP2x7EZAppNqyZEAVp8hydX2l27d2RPk/i3BC6HuDGLCmaLJn0iEdhTCC+KT1HwIrbu7b8Pbv2xiLMdlNHSa7ZUP5OeFR9VUAW0uwBiU1hLSJdO3OkWz763bCUm0CI9uVzBq05hcXNOkEmYvemSgL7p7WngLeEoM/nDr8iKQ5dNNE67F7w08Ik4e4rILRM5A7it6EJUgKxkK4OoxYJzVZc3dUWn072VBuI48vzOA3VP2C/qibzLoDJMe7KB4TNONY8OFcfhbqWEg1htNLfR5QK2qPaRi5u6XfDNeCcTOu/UHQVnVnQIiylQgyy18rGh8o9UuuUp+kUvCoLZmsJJvxwhqlWQiEn5U1EIJ5JLmEKtdJLVH8eg+6zlAaNujAnBRxZj/XJuUJ7QLW34WAwA6oI7rpKEd6id8N1l8mLLVd11cKBBMvYydSSGNdccemGV+3XIkFq82FGmwH3+LpoDvXnixgb1OThn5OweC2pls+FpvhlHJC6+ZF0LhvTJvnQgPgPAausPFIeLFUSsJ1Cid9Zpiq5vlKAVXTwkd3AY7m8cQCORf+7wbsGPOTRHRnQT8CeQZ48WIoFdy6uFVzP89d7qNZmGiKzLpHXP1bL3iwZNPmzZQvBGcWrsCRoVhRxM3btxIP8dsIcYTc3x0BJ1DRBzITt20kjKcpTo0GfZ/1p4=
  file_glob: true
  file: build/libs/fakemailserver*.war
  skip_cleanup: true
  on:
    repo: patlenain/fakemail-server
    tags: true
