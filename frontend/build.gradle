#!groovy

plugins {
	id 'com.moowork.node' version '1.2.0'
}

node {
	version = '8.9.1'
	download = true
}

task clean(type: Delete) {
	group = 'build'
	description = 'Clean-up generated files'
	delete "${projectDir}/coverage",
		fileTree(dir: projectDir, 
			includes: [ "TEST*.xml", "ut_report-*.xml" ])
}

task buildClientDev(type: NpmTask, dependsOn: 'npmInstall') {
	group = 'build'
	description = 'Compile client side folder for development'
	args = ['run','buildDev']
}

task buildClientWatch(type: NpmTask, dependsOn: 'npmInstall') {
	group = 'application'
	description = 'Build and watches the client side assets for rebuilding'
	args = ['run','buildWatch']
}

task buildClient(type: NpmTask, dependsOn: 'npmInstall') {
	group = 'build'
	description = 'Compile client side folder for production'
	args = ['run','build']
}

task testNpm(type: NpmTask, dependsOn: 'npmInstall') {
	group = 'verification'
	description = 'Launch unit tests'
	args = ['run', 'test']
}

task testCoverage(type: NpmTask, dependsOn: 'npmInstall') {
	group = 'verification'
	description = 'Launch coverage analysis'
	args = ['run', 'testCoverage']
}

